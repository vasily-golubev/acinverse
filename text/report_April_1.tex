\documentclass{article}
\usepackage[utf8x]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{graphicx}
\usepackage{todonotes}
\usepackage{hyperref}
\begin{document}
\title{Изучение методов сейсмической миграции на примере волнового уравнения}
\author{\textbf{Голубев В.И., Войнов О.Я.} \\ Лаборатория прикладной вычислительной геофизики МФТИ}
\maketitle

\section{Постановка задачи}
Изучение методов сейсмической миграции на примере волнового уравнения.
Разработка вычислительного алгоритма и компьютерной программы миграции на основе интегральной формулы Кирхгофа.
Разработка вычислительного алгоритма и компьютерной программы миграции на основе сопряженного оператора для волнового уравнения.
Сравнительный анализ двух алгоритмов на простых моделях.
Лидер проекта – Василий Голубев.
Рекомендуемые разделы книги “Geophysical inverse theory and regularization problems” - раздел 15.4 стр 503 - 516.

\section{Введение}

\section{Комментарии}

Для ясности опишем кратко использованные программные продукты.

KirScal - программа для расчёта интеграла Кирхгофа в трёхмерной постановке для волнового уравнения (однородная среда). Предполагается, что на верхней границе полупространства задаётся произвольный источник, производится построение волнового поля в заданный момент времени. Разработана Голубевым В.И.

AcInverse - программа для построения миграционного изображения (волновое уравнение) с использованием формулы Кирхгофа (приближение Рэлея).
Разработана Голубевым В.И.

Borni - программа для решения прямой задачи (волновое уравнение) и построения миграционного изображения на основе подхода с присоединённым оператором.
При этом матрица связи наблюдений и параметров модели получена с использованием приближения Борна (частотная область).
Миграционное изображение строится на основе least-square migration.
Разработана Войновым О.Я.

Madagascar - OpenSource комплекс для моделирования/обработки данных сейсмической разведки.
Включает широкий спектр программ, как для прямого моделирования и построения синтетических сейсмограмм, так и для решения обратных задач (миграция, инверсия).
Разработка начата в 2003 году, проект актуален (например, Workshop August 2014).

\section{Теория}

Динамическое поведение акустической среды (распределение отклонения давления в ней от стационарного значения)
может быть описано следующим волновым уравнением (\cite{Zhdanov_2007}, 13.54):
\begin{equation}
\label{wave_equation}
\nabla^2P(\vec{r},t) - \frac{1}{c^2(\vec{r})}\frac{\partial^2}{\partial t^2}
	P(\vec{r},t) = - F^e(\vec{r},t),
\end{equation}

где - $P(\vec{r},t)$ - поле давления, $F^e(\vec{r},t)$ - напряжение внешнего источника, $c(\vec{r})$
- скорость распространения волны в среде.

\subsection{Решение прямой задачи. Интеграл Кирхгофа}

Рассмотрим задачу о воздействии динамического источника на поверхность некоторого объёма среды.
В этом случае значение давления во внутренней точке области $\vec{r'}$ в момент времени $t'$ может быть выражено следующей формулой (\cite{Zhdanov_2007}, 13.112):
\begin{equation}
\label{eq_kirchhoff_common}
P(\vec{r'}, t') = \int_S \int_{-\infty}^{+\infty} [G^w(\vec{r'}, t' | \vec{r}, t) \frac{\partial}
{\partial n} P(\vec{r}, t) - P(\vec{r}, t) \frac{\partial}{\partial n} G^w(\vec{r'}, t' |
\vec{r}, t)] dt ds,
\end{equation}

где интеграл берётся по поверхности, ограничивающей объём, а функция $G^w(\vec{r'}, t' | \vec{r}, t)$ называется функцией Грина и является решением уравнения \ref{wave_equation} для случая внешнего воздействия в виде дельта-функции.

Пусть $c(\vec{r'}) = const$, т.е. среда является изотропной.
Тогда функция Грина может быть получена аналитически:
\begin{equation}
\label{eq_grin_function}
G^w(\vec{r}, t | \vec{r'}, t') = \frac{1}{4\pi|\vec{r} - \vec{r'}|}\delta(t - t' - \frac{|\vec{r} -
\vec{r'}|}{c}),
\end{equation}
где $\vec{r'}, t'$ - место расположения источника и время, в которое он начал действовать.

Подставляя в (\ref{eq_kirchhoff_common}) выражение для функции Грина в явном виде (\ref{eq_grin_function}) получим
\begin{equation}
\label{eq_kirchhoff_homogeneous}
P(\vec{r'}, t') = \frac{1}{4\pi} \int_S [\frac{1}{c|\vec{r'} - \vec{r}|}
\frac{\partial |\vec{r'} - \vec{r}|}{\partial n}\frac{\partial P'}{\partial t'}
- \frac{\partial}{\partial n}(\frac{1}{|\vec{r'} - \vec{r}|}) P' + 
\frac{1}{|\vec{r'} - \vec{r}|}\frac{\partial}{\partial n}P'] ds,
\end{equation}
где $P' = P(\vec{r}, t' - \frac{|\vec{r'} - \vec{r}|}{c})$.
 
Для задач сейсмики актуальна задача о распространении сейсмических волн в полупространстве (от дневной поверхности вниз и обратно после отражения от неоднородностей).
При такой постановке $\frac{\partial}{\partial n} = -\frac{\partial}{\partial z}$, поэтому выражение (\ref{eq_kirchhoff_homogeneous}) может быть упрощено до вида:
\begin{equation}
\label{eq_kirchhoff_final}
P(\vec{r'}, t') = \frac{1}{4\pi} \int_S [\frac{z' - z}{|\vec{r'} - \vec{r}|}(\frac{1}{c}
\frac{\partial P'}{\partial t'} + \frac{1}{|\vec{r'} - \vec{r}|^2} P') - \frac{1}{|\vec{r'}
- \vec{r}|}\frac{\partial P'}{\partial z}] ds
\end{equation}

Пусть, например, дополнительно известна функция источника (импульс Риккера):
\begin{equation}
\label{eq_ricker_wavelet}
P_{ricker} = P_0(1-2 \pi^2f^2t^2)e^{-\pi^2f^2t^2}.
\end{equation}

Тогда могут быть явно вычислены производные, стоящие в выражении (\ref{eq_kirchhoff_final}):
\begin{equation}
\label{eq_dp'_dt'}
\frac{\partial P'}{\partial t'} = -2\pi^2f^2P_0(3-2 \pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2)e^{-\pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2},
\end{equation}
и
\begin{equation}
\label{eq_dp'_dz}
\frac{\partial P'}{\partial z} = -2\pi^2f^2P_0(t' - \frac{|\vec{r'} - \vec{r}|}{c})[3-2 \pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2]e^{-\pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2}
\frac{z'-z}{c|\vec{r'}-\vec{r}|},
\end{equation}
а функция $P'(\vec{r'}, t')$ может быть записана в виде:
\begin{equation}
\label{eq_surface_pressure}
P'(\vec{r'}, t') = P(\vec{r}, t' - \frac{|\vec{r'} - \vec{r}|}{c}) = P_0(1-2 \pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2)e^{-\pi^2f^2(t'-\frac{|\vec{r'} - \vec{r}|}{c})^2}.
\end{equation}

\subsection{Миграция. Интеграл Кирхгофа.}

Центральной задачей сейсмической разведки является восстановление внутренней структуры геологической среды на основе полевых сейсмограмм - движения дневной поверхности
из-за отражённых от подповерхностных неоднородностей волн.
При этом принято различать два близких подхода: определение положения отражающих горизонтов (миграция) и восстановление скоростной модели среды (инверсия).

В книге \cite{Zhdanov_2007} изложена теория, позволяющая рассчитать пространственное распределение скалярного параметра $U^m(\vec{r'})$, высокие значения которого соответствуют
глубине расположения отражающего горизонта.
Для случая горизонтальной плоскости наблюдения расчётная формула представима в виде (\cite{Zhdanov_2007}, 15.208):
\begin{equation}
\label{rayleigh_migration}
U^m(\vec{r'},0) = -\frac{1}{2\pi}\frac{\partial}{\partial z'}
	\int_S \frac{U(\vec{r},\frac{2|\vec{r'}-\vec{r}|}{c})}{|\vec{r'}-\vec{r}|}ds,
\end{equation}
где $\vec{r}$ - координата на поверхности, в которой записывается сейсмограмма, $\vec{r'}$ - координата в объёме, где ищется мигрированное изображение, $c$ - скорость распространения волн.

\subsection{Миграция. Приближение Борна.}

\section{Численное моделирование}

\subsection{Решение прямой задачи. Интеграл Кирхгофа}

Была разработана программа KirScal на языке Python, которая вычисляет численно интеграл (\ref{eq_kirchhoff_final}) методом прямоугольников с подстановкой (\ref{eq_dp'_dt'} и \ref{eq_dp'_dz}).
Проведён расчёт с $C_P = 2000$ м/с, $f = 10$ Гц.
На рисунках (\ref{img_point_1} - \ref{img_point_3}) представлены волновые картины при воздействии точечного источника.
Как видно, происходит распространение сферической волны от места расположения источника вглубь среды.

\begin{figure}[ht]
  \center
  \includegraphics[scale=0.2]{pic_kirchhoff_scalar/point_1.png}
  \caption{Через 100 мс}
\label{img_point_1}
\end{figure}
\begin{figure}[ht]
  \center
  \includegraphics[scale=0.2]{pic_kirchhoff_scalar/point_2.png}
  \caption{Через 200 мс}
\label{img_point_2}
\end{figure}
\begin{figure}[ht]
  \center
  \includegraphics[scale=0.2]{pic_kirchhoff_scalar/point_3.png}
  \caption{Через 300 мс}
\label{img_point_3}
\end{figure}

\subsection{Миграция. Интеграл Кирхгофа.}

Рассмотрим простейший случай, когда расчётная сетка кубическая, и на поверхности сейсмоприёмники расположены в каждом её узле.
В таком случае формула (\ref{rayleigh_migration}) может быть записана в виде:
\begin{equation}
\label{rayleigh_migration_discrete}
U^m(i,j,k) = -\frac{1}{2\pi}\frac{\sum\limits_{l,m} \frac{U(l,m,\frac{2d(i,j,k+1,l,m)}{c})}{d(i,j,k+1,l,m)}\delta x \delta y - \sum\limits_{l,m} \frac{U(l,m,\frac{2d(i,j,k,l,m)}{c})}{d(i,j,k,l,m)}\delta x \delta y}{\delta z},
\end{equation}
где $d(i,j,k,l,m)=\sqrt{(l-i)^2(\delta x)^2 + (m-j)^2(\delta y)^2  + (k)^2(\delta z)^2}$, а начало координат находится в точке $(i,j,k)=(0,0,0)$.

\subsection{ПО Madagascar.}

Существует несколько программных комплексов, ориентированных на моделирование сейсмических процессов.
К ним относятся, например, Madagascar (www.ahay.org), Seismic Unix (www.seismicunix.com) и т.д.
В ходе выполнения исследовательской работы был частично освоен Madagascar.
Остановимся на одной его программе, называющейся sfkirmod.
С её помощью можно получать синтетические сейсмограммы для геологической среды (2D, для 3D можно использовать sfkirmod3) в акустическом приближении с:
- постоянной скоростью распространения волн, - постоянным градиентом скорости, - постоянным градиентом квадрата скорости.
Алгоритм работы программы основан на статье [1].

Для иллюстрации работы sfkirmod был проведён расчёт распространения сейсмического сигнала в однородной модели среды со скоростью 2500 м/с размерами 10 км x 5 км при
наличии отражающей границы на глубине 2,5 км.
На рисунке \ref{seismo_1} показана сейсмограмма для следующей расстановки: 1 источник в точке (0, 5), 2001 приёмник слева направо вдоль всех 10 км модели с интервалом 5 м.
Функция источника - Риккер 25 Гц.

\begin{figure}[ht]
  \center
  \includegraphics[scale=0.3]{/home/vgolubev/work/github/acinverse/madagascar/report/Fig/Figure_1.png}
  \caption{Сейсмограмма с одной прямой границей.}
\label{seismo_1}
\end{figure}

Также имеется возможность построения Zero-Offset сейсмограммы, т.е. когда каждая сейсмотрасса получена в условиях совпадения координат источника и приёмника.
На рисунке \ref{seismo_2} показана ZO-сейсмограмма для той же самой модели среды.
Использовался 2001 источник-приёмник с интервалом 50 м на всё протяжении расчётной области.

\begin{figure}[ht]
  \center
  \includegraphics[scale=0.3]{/home/vgolubev/work/github/acinverse/madagascar/report/Fig/Figure_2.png}
  \caption{ZO-cейсмограмма с одной прямой границей.}
\label{seismo_2}
\end{figure}

При этом программа kirmod позволяет получить синтетическую сейсмограмму для произвольного распределения отражающих границ в пространстве.
Например, их можно задавать аналитическими функциями.
Для примера была рассчитана модель среды с тремя отражающими горизонтами, два из которых криволинейные.
Границы задавались функциями $(3.0 - 0.1 * x_1$, $0.5 * exp((x_1 - 5.0)^2 / 25) - 0.4$ и $-3.0 + 0.1 * x_1 + exp((x_1 - 5.0)^2 / 25) - 0.8$ соответственно.
Параметры расстановки выбирались аналогично предыдущему расчёту.

\begin{figure}[ht]
  \center
  \includegraphics[scale=0.3]{/home/vgolubev/work/github/acinverse/madagascar/report/Fig/Figure_3.png}
  \caption{Сейсмограмма для модели с тремя отражающими горизонтами.}
\label{seismo_3}
\end{figure}

\begin{figure}[ht]
  \center
  \includegraphics[scale=0.3]{/home/vgolubev/work/github/acinverse/madagascar/report/Fig/Figure_4.png}
  \caption{ZO-сейсмограмма для модели с тремя отражающими горизонтами.}
\label{seismo_4}
\end{figure}

\subsection{Миграция. Приближение Борна.}

\subsection{Сравнительный анализ двух алгоритмов миграции (Кирхгоф, Борн) на простых моделях}

Одной из целей работы являлось сравнение двух методов миграции (Кирхгоф и присоединённый оператор), реализованных в программах AcInverse и Borni.
Исследовалась 2D модель с двумя отражающими горизонтами\footnote{При расчёте сейсмограммы в Borni отражающие границы образовывались как результат включения одной большой неоднородности с $\delta s = 4*10^{-6}$}, которые задавались формулами:
\begin{itemize}
\item $z=-2$,
\item $z=-2 + (0.1 * x + 0.5)$.
\end{itemize}
Фоновая скорость распространения продольных волн 2500 м/с, геометрия расчётной области 10 км x 5 км.
Временная функция источника - Риккер с основной частотой 25 Гц.
В измерительную систему входил 201 источник и 201 приёмник, установленные каждые 50 м.

На рисунке \ref{seismo_verif_zo_madagascar_borni} (слева) приведена Zero-Offset-сейсмограмма, рассчитанная методом Кирхгофа (Madagascar, kirmod), а справа - программой Borni.
Как видно, Кирхгоф дал более чёткое изображение, хотя и с наличием сферических артефактов у границ области.
Таким образом, для тестирования алгоритмов миграции было получено два набора входных данных разными методами.

\begin{figure}[ht]\center
\begin{tabular}{cc}
\includegraphics[width=50mm]{/home/vgolubev/work/github/acinverse/madagascar/report/Fig/seismo_verif_zo_madagascar_borni-madagascar.png}
&
\includegraphics[width=60mm]{/home/vgolubev/work/github/acinverse/borni/seismo_verif_zo_madagascar_borni-borni.png}
\end{tabular}
\caption{ZO-сейсмограмма для верификационной модели. Слева - Madagascar, справа - Borni.}
\label{seismo_verif_zo_madagascar_borni}
\end{figure}

На рисунке \ref{seismo_verif_madagascar_borni-acinverse} представлены миграционные изображения, полученные методом Кирхгофа (AcInverse).
Можно говорить о выделяемости контактных границ, пусть и с небольшим контрастом и наличием артефактов.

\begin{figure}[ht]\center
\includegraphics[width=100mm]{/home/vgolubev/work/github/acinverse/madagascar/report/Fig/seismo_verif_madagascar_borni-acinverse.png}
\caption{Миграционное изображение для верификационной модели, полученное методом Кирхгофа (AcInverse). Слева - на входе Борн (Borni), справа - на входе Кирхгоф (Madagascar).}
\label{seismo_verif_madagascar_borni-acinverse}
\end{figure}

На рисунке \ref{seismo_verif_madagascar_borni-borni} представлены миграционные изображения, полученные методом присоединённого оператора (Борн, Borni).

\begin{figure}[ht]\center
\includegraphics[width=120mm]{/home/vgolubev/work/github/acinverse/borni/seismo_verif_madagascar_borni-borni.png}
\caption{Миграционное изображение для верификационной модели, полученное методом присоединённого оператора (Борн, Borni). Слева - на входе Борн (Borni), справа - на входе Кирхгоф (Madagascar).}
\label{seismo_verif_madagascar_borni-borni}
\end{figure}

\section{Направления дальнейшего исследования}

В мартовский отчёт планируется включить приведённое выше сравнение методов миграции на трёхслойной модели в рамках задачи "Сравнительный анализ двух алгоритмов на простых моделях" и отдельные исследования (теория, чувствительность к параметрам) процедур миграции по Кирхгофу и Adjoint operator (Borne approximation).

Кроме того сформулированы направления дальнейшего исследования, с приоритетом которых нет чёткой определённости: 

\begin{enumerate}
\item Провести детальное исследование поведения алгоритмов миграции (AcInverse, Borni) при изменении расчётных параметров.
\item Провести верификационные сравнения таким же способом (К-К, Б-Б, К-Б, Б-К) на 2Д слоистых моделях с криволинейными границами, т.о. усложнив "простые модели".
\item Освоить в Madagascar решение прямой задачи FD методом (или доработать сеточно-характеристический метод), получить синтетическую ZO-сейсмограмму от верификационной трёхслойной модели и попробовать применить миграцию AcInverse и Borni.
\item Продлить границы 2Д модели вдоль третьей оси, чтобы получить 3Д, и провести верификационное тестирование на полученной 3Д модели.
\item Освоить Madagascar с целью построения ZO-сейсмограммы для сложной модели (например, Marmousi) и попробовать применить миграцию AcInverse и Borni.
\item Доработать Borni для реализации regularized least-square migration.
\item Перейти к построению матрицы L на основе finite-difference approximation, а потом реализовать аналог Borni на её основе.
\end{enumerate}

\section{Заключение}

\bibliographystyle{acm}
\bibliography{report_April_1}

\end{document}
